'''
export all open layers in Qgis into a text file
also export all related-files of open layers into a different text file
use for sgrt tile
'''

import sys, os, fnmatch

in_path = "/eodc/private/tuwgeo/datapool_processed/Sentinel-1_CSAR/IWGRDH/preprocessed/datasets/resampled/A0101/EQUI7_EU010M/"

in_list = ["20151107_064727--_SIG0-----_S1AIWGRDH1VVD_023_A0101_EU010M_E035N024T1",
"20151107_064752--_SIG0-----_S1AIWGRDH1VVD_023_A0101_EU010M_E035N024T1",
"20151107_064727--_SIG0-----_S1AIWGRDH1VVD_023_A0101_EU010M_E035N025T1",
"20151107_064727--_SIG0-----_S1AIWGRDH1VHD_023_A0101_EU010M_E036N025T1",
"20151107_064727--_SIG0-----_S1AIWGRDH1VVD_023_A0101_EU010M_E036N025T1",
"20151107_064727--_SIG0-----_S1AIWGRDH1VVD_023_A0101_EU010M_E037N024T1",
"20141013_170842--_SIG0-----_S1AIWGRDH1VHA_117_A0101_EU010M_E048N023T1",
"20151008_170857--_SIG0-----_S1AIWGRDH1VVA_117_A0101_EU010M_E048N023T1",
"20160317_171652--_SIG0-----_S1AIWGRDH1VVA_015_A0101_EU010M_E048N023T1",
"20160705_054909--_SIG0-----_S1AIWGRDH1VHD_037_A0101_EU010M_E048N023T1",
"20160705_054909--_SIG0-----_S1AIWGRDH1VVD_037_A0101_EU010M_E048N023T1",
"20160705_054914--_SIG0-----_S1AIWGRDH1VHD_037_A0101_EU010M_E048N023T1",
"20160705_054914--_SIG0-----_S1AIWGRDH1VVD_037_A0101_EU010M_E048N023T1",
"20160920_170849--_SIG0-----_S1AIWGRDH1VHA_117_A0101_EU010M_E048N023T1",
"20161011_053256--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E048N023T1",
"20161011_053237--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E048N023T1",
"20141013_170842--_SIG0-----_S1AIWGRDH1VHA_117_A0101_EU010M_E049N023T1",
"20141013_170842--_SIG0-----_S1AIWGRDH1VVA_117_A0101_EU010M_E049N023T1",
"20141022_053239--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E049N023T1",
"20151008_170857--_SIG0-----_S1AIWGRDH1VVA_117_A0101_EU010M_E049N023T1",
"20160613_053248--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E049N023T1",
"20160613_053257--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E049N023T1",
"20160920_170849--_SIG0-----_S1AIWGRDH1VHA_117_A0101_EU010M_E049N023T1",
"20160920_170849--_SIG0-----_S1AIWGRDH1VVA_117_A0101_EU010M_E049N023T1",
"20161011_053237--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E049N023T1",
"20161011_053256--_SIG0-----_S1AIWGRDH1VHD_066_A0101_EU010M_E049N023T1",
"20161011_053237--_SIG0-----_S1AIWGRDH1VVD_066_A0101_EU010M_E049N023T1",
"20161011_053256--_SIG0-----_S1AIWGRDH1VVD_066_A0101_EU010M_E049N023T1"]

# out folder
OutFolder = 'temp'
# if not exist, create output folder
if not os.path.exists(OutFolder):
    os.makedirs(OutFolder)
# open file for writing
tf = open(OutFolder + os.sep + "List_all.txt", 'w')
tf_full = open(OutFolder + os.sep + "List_to_removed.txt", 'w')

# loop through open layers
for file in in_list:
    in_path_file = os.path.join(in_path,file[-10:])
    # write open layers to file
    tf.write("%s\n" % file)
    # take all file which correspond to the file above
    for file_all in fnmatch.filter(os.listdir(in_path_file), ("*" + file[1:-57] + "*.tif")):
        tf_full.write(in_path_file + os.sep + file_all + '\n')
tf.close()
tf_full.close()

